<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Estados del agua – Modelo molecular 3D</title>

<style>
body {
  margin: 0;
  font-family: 'Segoe UI', Arial, sans-serif;
  background: #f7f7f7;
}

header {
  background: #5A2382;
  color: white;
  padding: 15px;
  text-align: center;
}

header h1 {
  margin: 0;
  font-size: 26px;
}

header p {
  margin: 5px 0 0;
  font-size: 14px;
}

#layout {
  display: flex;
  justify-content: center;
  gap: 20px;
  padding: 20px;
}

#panel {
  width: 260px;
  background: white;
  border-radius: 8px;
  padding: 15px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.15);
}

#panel h2 {
  color: #0087C8;
  font-size: 18px;
  margin-top: 0;
}

#panel input[type=range] {
  width: 100%;
}

#estado {
  font-weight: bold;
}

#explicacion {
  margin-top: 10px;
  font-size: 14px;
  background: #f0f8ff;
  padding: 10px;
  border-radius: 5px;
}

#scene {
  width: 600px;
  height: 400px;
  background: white;
  border-radius: 8px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.15);
}
</style>
</head>

<body>

<header>
  <h1>Estados de la materia – Agua</h1>
  <p>Mové la temperatura y observá cómo se comportan las moléculas</p>
</header>

<div id="layout">

  <div id="panel">
    <h2>Temperatura</h2>

    <input type="range" id="temp" min="-20" max="120" value="20">
    <p><strong><span id="t">20</span> °C</strong></p>

    <p>Estado: <span id="estado">Líquido</span></p>

    <div id="explicacion">
      Las moléculas están juntas y se deslizan unas sobre otras.
    </div>
  </div>

  <div id="scene"></div>

</div>

<script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>

<script>
const container = document.getElementById("scene");

// ESCENA
const scene = new THREE.Scene();
scene.background = new THREE.Color(0xf0f0f0);

// CÁMARA
const camera = new THREE.PerspectiveCamera(75, 600/400, 0.1, 100);
camera.position.z = 12;

// RENDER
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(600, 400);
container.appendChild(renderer.domElement);

// LUZ
scene.add(new THREE.AmbientLight(0xffffff, 0.6));
const light = new THREE.PointLight(0xffffff, 0.8);
light.position.set(10,10,10);
scene.add(light);

// MOLÉCULAS
const molecules = [];
const N = 30;
const limits = 4;

for (let i=0; i<N; i++) {
  const geo = new THREE.SphereGeometry(0.3, 16, 16);
  const mat = new THREE.MeshStandardMaterial({color: 0x0087C8});
  const m = new THREE.Mesh(geo, mat);

  m.position.set(
    (Math.random()-0.5)*3,
    (Math.random()-0.5)*3,
    (Math.random()-0.5)*3
  );

  m.velocity = new THREE.Vector3();
  m.home = m.position.clone();

  molecules.push(m);
  scene.add(m);
}

let estado = "liquido";

function actualizarEstado() {
  const T = temp.value;
  t.innerText = T;

  if (T < 0) {
    estado = "solido";
    estadoTxt("Sólido",
      "Las moléculas vibran en su lugar, pero no se desplazan.");
  }
  else if (T >= 100) {
    estado = "gaseoso";
    estadoTxt("Gaseoso",
      "Las moléculas se mueven muy rápido y ocupan todo el espacio.");
  }
  else {
    estado = "liquido";
    estadoTxt("Líquido",
      "Las moléculas están juntas y se deslizan unas sobre otras.");
  }
}

function estadoTxt(nombre, texto) {
  document.getElementById("estado").innerText = nombre;
  document.getElementById("explicacion").innerText = texto;
}

temp.oninput = actualizarEstado;

// ANIMACIÓN
function animate() {
  requestAnimationFrame(animate);

  molecules.forEach(m => {

    if (estado === "solido") {
      m.position.x = m.home.x + (Math.random()-0.5)*0.05;
      m.position.y = m.home.y + (Math.random()-0.5)*0.05;
      m.position.z = m.home.z + (Math.random()-0.5)*0.05;
      m.velocity.set(0,0,0);
    }

    if (estado === "liquido") {
      m.velocity.add(new THREE.Vector3(
        (Math.random()-0.5)*0.03,
        (Math.random()-0.5)*0.03,
        (Math.random()-0.5)*0.03
      ));
      m.velocity.multiplyScalar(0.85);
      m.position.add(m.velocity);
    }

    if (estado === "gaseoso") {
      m.velocity.add(new THREE.Vector3(
        (Math.random()-0.5)*0.05,
        (Math.random()-0.5)*0.05,
        (Math.random()-0.5)*0.05
      ));
      m.position.add(m.velocity);
    }

    ["x","y","z"].forEach(a=>{
      if (Math.abs(m.position[a]) > limits) m.velocity[a] *= -1;
    });
  });

  renderer.render(scene, camera);
}

actualizarEstado();
animate();
</script>

</body>
</html>
