<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Estados de la materia – Modelo molecular</title>

<script src="https://cdn.jsdelivr.net/pyodide/v0.25.1/full/pyodide.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f7f7f7;
  padding: 20px;
}

h1 { color: #5A2382; }
h2 { color: #0087C8; }

button {
  padding: 10px 15px;
  margin: 5px;
  background: #E6500F;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

input[type=range] {
  width: 300px;
}

.box {
  background: white;
  padding: 15px;
  border-radius: 8px;
  margin-top: 15px;
}
</style>
</head>

<body>

<h1>Estados de la materia</h1>

<div class="box">
<h2>Consigna</h2>
<p>
Mové el control de temperatura y observá:
<br>
<b>¿Cómo están ubicadas las partículas?</b>
<br>
<b>¿Cómo se mueven?</b>
</p>
</div>

<div class="box">
<p>Temperatura: <span id="tempValor">20</span> °C</p>
<input type="range" min="-10" max="120" value="20" id="temp" oninput="actualizarTemp()">
<br><br>
<button onclick="simular()">Simular</button>
</div>

<div class="box">
<strong>Estado:</strong> <span id="estadoTexto">Líquido</span>
</div>

<div class="box">
<p>Modelo molecular:</p>
</div>

<script>
let pyodide;

async function iniciar() {
  pyodide = await loadPyodide();
  await pyodide.loadPackage("matplotlib");
}
iniciar();

function actualizarTemp() {
  const t = document.getElementById("temp").value;
  document.getElementById("tempValor").innerText = t;

  let estado = "Líquido";
  if (t < 0) estado = "Sólido";
  if (t >= 100) estado = "Gaseoso";

  document.getElementById("estadoTexto").innerText = estado;
}

async function simular() {
  const t = document.getElementById("temp").value;

  let estado = "liquido";
  if (t < 0) estado = "solido";
  if (t >= 100) estado = "gaseoso";

  const codigo = `
import matplotlib
matplotlib.use("module://matplotlib_pyodide.html5_canvas")

import matplotlib.pyplot as plt
import random
import numpy as np

N = 36

x = []
y = []

# POSICIONES INICIALES SEGÚN ESTADO
if "${estado}" == "solido":
    for i in range(6):
        for j in range(6):
            x.append(i * 0.15)
            y.append(j * 0.15)
    movimiento = 0.01

elif "${estado}" == "liquido":
    for _ in range(N):
        x.append(random.uniform(0.2, 0.8))
        y.append(random.uniform(0.2, 0.8))
    movimiento = 0.05

else:  # gaseoso
    for _ in range(N):
        x.append(random.uniform(0, 1))
        y.append(random.uniform(0, 1))
    movimiento = 0.15

# SIMULACIÓN DE MOVIMIENTO (trayectoria corta)
plt.figure()

for _ in range(15):
    for i in range(N):
        x[i] += random.uniform(-movimiento, movimiento)
        y[i] += random.uniform(-movimiento, movimiento)
        x[i] = min(max(x[i], 0), 1)
        y[i] = min(max(y[i], 0), 1)
    plt.scatter(x, y, color="blue", alpha=0.6)

plt.title("Estado: ${estado}")
plt.xlim(0,1)
plt.ylim(0,1)
plt.show()
  `;

  await pyodide.runPythonAsync(codigo);
}
</script>

</body>
</html>
