<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Estados de la materia – Modelo molecular (3D)</title>

<script src="https://www.glowscript.org/lib/glow.3.2.min.js"></script>
<script src="https://www.glowscript.org/lib/RSrun.3.2.min.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f7f7f7;
  padding: 20px;
}

h1 { color: #5A2382; }
h2 { color: #0087C8; }

.box {
  background: white;
  padding: 15px;
  border-radius: 8px;
  margin-top: 15px;
}
</style>
</head>

<body>

<h1>Estados de la materia</h1>

<div class="box">
<h2>Consigna</h2>
<p>
Mové la temperatura y observá:<br>
<b>¿Qué tan juntas están las partículas?</b><br>
<b>¿Cómo cambia su movimiento?</b>
</p>
</div>

<div class="box">
Temperatura:
<span id="tempValor">20</span> °C<br>
<input type="range" min="-10" max="120" value="20" id="temp">
</div>

<div class="box">
<strong>Estado:</strong> <span id="estadoTexto">Líquido</span>
</div>

<script type="text/javascript">
let escena;
let particulas = [];

function iniciarEscena() {
  escena = canvas({
    width: 500,
    height: 400,
    background: color.white
  });
}

function crearParticulas(estado) {
  // borrar anteriores
  for (let p of particulas) p.visible = false;
  particulas = [];

  let velocidad = 0.5;
  let separacion = 1.2;

  if (estado === "solido") {
    velocidad = 0.1;
    separacion = 0.8;
  }
  if (estado === "liquido") {
    velocidad = 0.5;
    separacion = 1.2;
  }
  if (estado === "gaseoso") {
    velocidad = 2;
    separacion = 2.5;
  }

  for (let i = 0; i < 30; i++) {
    let p = sphere({
      pos: vector(
        (Math.random() - 0.5) * separacion * 5,
        (Math.random() - 0.5) * separacion * 5,
        (Math.random() - 0.5) * separacion * 5
      ),
      radius: 0.3,
      color: color.cyan
    });

    p.vel = vector(
      (Math.random() - 0.5) * velocidad,
      (Math.random() - 0.5) * velocidad,
      (Math.random() - 0.5) * velocidad
    );

    particulas.push(p);
  }
}

function actualizar() {
  const t = document.getElementById("temp").value;
  document.getElementById("tempValor").innerText = t;

  let estado = "liquido";
  if (t < 0) estado = "solido";
  if (t >= 100) estado = "gaseoso";

  document.getElementById("estadoTexto").innerText =
    estado.charAt(0).toUpperCase() + estado.slice(1);

  crearParticulas(estado);
}

function animar() {
  rate(60);
  for (let p of particulas) {
    p.pos = p.pos.add(p.vel);

    if (Math.abs(p.pos.x) > 5) p.vel.x *= -1;
    if (Math.abs(p.pos.y) > 5) p.vel.y *= -1;
    if (Math.abs(p.pos.z) > 5) p.vel.z *= -1;
  }
}

iniciarEscena();
actualizar();
setInterval(animar, 16);

document.getElementById("temp").oninput = actualizar;
</script>

</body>
</html>
